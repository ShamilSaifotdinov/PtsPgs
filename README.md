# PtsPgs (Точки-в-полигоны)
Плагин предназначен для создания большого количества полигонов из точек, образованных на основе таблицы координат (например, межевые планы, карта (план)).
![desc-main](https://user-images.githubusercontent.com/63447562/219465618-5d7db4b5-0c9a-4250-8ae0-68201e0a8ce0.png)

Для пользования плагин - необходимо скачать "PtsPgs.MBX" или "PtsPgs (геодезическая).MBX" (для перевернутых координат).
Непосредственная работа плагина представлена в пункте [4. Создание полигонов через плагин](#step-4), в пунктах 1 - 3 - подготовка данных.

## 1. Из документа в MapInfo
### 1) Переносим из документа (Word (.docx), PDF) в табличный формат (MS Excel (.XLSX), .csv, .txt)
![desc-1 1](https://user-images.githubusercontent.com/63447562/219467819-c0db2cd7-ce98-499a-8372-7f677b3e9e2d.png)

### 2) Открываем таблицу в MapInfo
При "Установки свойств полей" для колонок с координатами X и Y устанавливаем Тип "Вещественное", а для первой колонки (с номерами точек) - Целое
![desc-1 2](https://user-images.githubusercontent.com/63447562/219468470-768f0915-0f14-4338-a1a6-ea70e9ce6e58.png)

## 2. Создание точек
Для полей "Извлечь координаты..." устанавливает соответствующие колонки
![desc-2 1](https://user-images.githubusercontent.com/63447562/219470044-0ac2608c-84d5-47b9-9119-e13e5e3d102f.png)
Устанавливаем проекцию "План-схема (метры)" с границами с запасом (от 0 до 10 000 000)
![desc-2 2](https://user-images.githubusercontent.com/63447562/219470438-5cf88fe6-8364-4205-bf74-76c2681839c4.png)
### Результат - созданы точки:
![desc-2 3](https://user-images.githubusercontent.com/63447562/219470993-a6f85f8e-ed68-4c56-ba2a-26f922187d33.png)

## 3. Создание таблицы для будущих полигонов
Добавляем поле ID (Целое) и указываем Проекцию "План-схема (метры)" с необходимыми границами
> Внимание: в ID будут указаны номер первой точки полигона!

![desc-3 1](https://user-images.githubusercontent.com/63447562/219471710-f7cbbe4c-2e56-461d-a90d-ea10e19f8732.png)
![desc-3 2](https://user-images.githubusercontent.com/63447562/219471712-bb09ade9-823d-40ae-afd1-15ef6f83ff2b.png)

### После создания таблицы: таблиц с точками и таблица для будущих полигонов должны быть в одной карте и окно Карта должно быть активно
![desc-3 3](https://user-images.githubusercontent.com/63447562/219471686-d45ce646-f018-49c0-bde5-26d2f9c3020b.png)

## <span id="step-4">4. Создание полигонов через плагин</span>
Запускаем плагин. Для нашего случая будет использован "PtsPgs (геодезическая).MBX" с перестановкой местами между X и Y.
![desc-4 1](https://user-images.githubusercontent.com/63447562/219473880-e692f310-065c-4c14-9a8c-bf972b6f3b08.png)
1) Выбирается таблица с точками, на основе которых будут созданы полигоны

![desc-4 3](https://user-images.githubusercontent.com/63447562/219475038-ee1d22f1-3452-454f-b3fe-176110054d50.png)

2) Выбирается созданая таблица, куда будут создаваться полигоны

![desc-4 4](https://user-images.githubusercontent.com/63447562/219475041-5be984a6-ab53-426c-b633-1b5f522d0676.png)

После успешного создания полигонов появится окно об успешном завершении. В окне Сообщения указывается порядок выполнения плагина

![desc-4 5](https://user-images.githubusercontent.com/63447562/219475043-f8f963d2-d894-46cd-a73e-72a79d61a336.png)
### Результат:
![desc-4 7](https://user-images.githubusercontent.com/63447562/219477426-02c1b20e-ce6a-4828-ac4c-6f9f5ea57974.png)
